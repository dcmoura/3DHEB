<!DOCTYPE html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<title>3DHEB by Daniel C. Moura : Built with Processing and Processing.js</title>
		<link rel="icon"  type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAQAAVzABAEAjBQAaDwYAWjUGAGE6CQBrQQ0ATS8PAFhAJwBUQC8AbFI6AHVXPACBZk4A4NrWAPb19QAAAAAAAMmZmZmZmgAJIwAAAAAAcMIjPjA+PjAKpxIuMDMzMAm0Ii4zMzMACaIiLt3dMAAJtyIuIzPQAAm0Un5yM+IzKLRkfncy4iIotRF+dyLkIiq0QX53F+EiGrQUTkd34iIatEVu7u5iIVrBVVRBRFRVbAtGZGZla2uwAMu7u7u8vADAAwAAgAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIABAADAAwAA" />
		<meta name="Generator" content="Processing" />
		<!-- - - - - - - - - - - - - - - - - - - - - 
		+
		+    Wondering how this works? 
		+
		+    Go to: http://processing.org/
		+    and: http://processingjs.org/
		+
		+ - - - - - - - - - - - - - - - - - - - - -->
		<style type="text/css">
	body {
	  background-color: #333; color: #bbb; line-height: normal;
	  font-family: Lucida Grande, Lucida Sans, Arial, Helvetica Neue, Verdana, Geneva, sans-serif;
	  font-size: 11px; font-weight: normal; text-decoration: none;
		  line-height: 1.5em;
	}
	a img { 
		border: 0px solid transparent;
	}
	a, a:link, a:visited, a:active, a:hover { 
		color: #cdcdcd; text-decoration: underline;
	}
	h1 {
	    font-family: Arial, Helvetica Neue, Verdana, Geneva, sans-serif;
		width: 100%; letter-spacing: 0.1em;
		margin-bottom: 1em; font-size: 1.65em;
	}
	canvas { 
		display: block; 
		outline: 0px; 
		margin-bottom: 1.5em; 
	}
	#content { 
		margin: 50px auto 0px auto; padding: 25px 25px 15px 25px;
		width: 800px; min-width: 300px; overflow: auto;
		border-left: 1px solid #444; border-top: 1px solid #444; 
		border-right: 1px solid #333; border-bottom: 1px solid #333;
		background-color: #3d3d3d;
	}
	
	
	
	
	

	
	
	
		</style>
		<!--[if lt IE 9]>
			<script type="text/javascript">alert("Your browser does not support the canvas tag.");</script>
		<![endif]-->
		

		<script src="processing.js" type="text/javascript"></script>
		<script src="spin.js" type="text/javascript"></script>
		<script type="text/javascript">
		
// convenience function to get the id attribute of generated sketch html element
function getProcessingSketchId () { return 'threeDHEBjs'; }
function ps() { return Processing.getInstanceById(getProcessingSketchId()); }

</script>

	</head>
	<body>
	

<script>

  var dataURL;
  var spinner;

  function loadURLGraph() {
	   ps().loadGraph(dataURL);
	   spinner.stop();
  }  
  
  function loadGraph(name) {
  	dataURL = name;
  	dospin();
    setTimeout(   loadURLGraph, 50);		      
  }
  
  function setCriteria(val) {
  	dospin();
  	setTimeout( function() {  ps().setCriteria(val);  spinner.stop();}, 50);
  }
  
  function setSeparationFactor(val) {
	dospin();
  	setTimeout( function() {  ps().setSeparationFactor(val);  spinner.stop();}, 50);
  }
  
  function iteration(val) {
	dospin();
  	setTimeout( function() {  ps().iteration(val);  spinner.stop();}, 50);
  }
  
  function reset() {
	dospin();
  	setTimeout( function() {  ps().reset();  spinner.stop();}, 50);
  }
  
  function setInvertColors(val) {
	dospin();
  	setTimeout( function() {  ps().setInvertColors(val);  spinner.stop();}, 50);
  }
  
  function setUseWeight(val) {
	dospin();
  	setTimeout( function() {  ps().setUseWeight(val);  spinner.stop();}, 50);
  }
  
  function setEdgeAlpha(val) {
	dospin();
  	setTimeout( function() {  ps().setEdgeAlpha(val);  spinner.stop();}, 50);
  }
  
  
  
  
  
   function dospin() {
  	var opts = {
	  lines: 13, // The number of lines to draw
	  length: 20, // The length of each line
	  width: 10, // The line thickness
	  radius: 30, // The radius of the inner circle
	  corners: 1, // Corner roundness (0..1)
	  rotate: 0, // The rotation offset
	  direction: 1, // 1: clockwise, -1: counterclockwise
	  color: '#AAA', // #rgb or #rrggbb or array of colors
	  speed: 1, // Rounds per second
	  trail: 60, // Afterglow percentage
	  shadow: false, // Whether to render a shadow
	  hwaccel: false, // Whether to use hardware acceleration
	  className: 'spinner', // The CSS class to assign to the spinner
	  zIndex: 2e9, // The z-index (defaults to 2000000000)
	  top: '50%', // Top position relative to parent
	  left: '50%' // Left position relative to parent
	};
	var target = document.getElementById('content');
	spinner = new Spinner(opts).spin(target);
  }


  var openFile = function(event) {
    var input = event.target;
    var reader = new FileReader();
    
        
    reader.onload = 
    	function(){
    		
    
		      dataURL = reader.result;
		      
		      var output = document.getElementById('src_file');
		      output.checked = 1;
      
     		  
     		  dospin();
      
      		  setTimeout(   loadURLGraph, 50);
		          		      
	    };
    reader.readAsDataURL(input.files[0]);
    //reader.readAsText(input.files[0]);
  };
  
  

 

</script>

	
	
		<div id="content"
		style="overflow: hidden; width: 1050px">
		
		
		
<div id="divform" style="float: left; width: 200px;">




<font size=3 color="white">First, select a graph</font></big><br><br>	

<input type="radio" name="source" value="1000.random" checked onclick="loadGraph('1000.random');">Random (1K edges)
<br>
<input type="radio" name="source" value="airlines_original.graphml" onclick="loadGraph('airlines_original.graphml');">US Airlines (1K edges)
<br>
<input type="radio" name="source" value="migrations.graphml" onclick="loadGraph('migrations.graphml');">US Migrations (10K edges)
<br>
<input type="radio" name="source" value="file" id="src_file" >GraphML file: <input type='file' accept='text/graphml' onchange='openFile(event)'>
<br>
<br>

<br>
<br>
<font size=3 color="white">Then, bundle!</font></big><br><br>	

Bundling criteria <select onchange="setCriteria(this.value);">
  <option value="0">Default</option>
  <option value="2">Flow</option>
</select><br><br>
Sigma<br><input step="0.005" max="0.1" min="0.001" value="0.03" name="kernelSigma" type="range"  onchange="ps().setSigma(this.value);"><br><br>
Step<br><input step="0.05" max="0.95" min="0.50" value="0.90" name="hStep" type="range" onchange="ps().setHStep(this.value);"><br><br>
Edge smoothing<br><input step="0.05" max="1.0" min="0.0" value="0.25" name="smoothingAlpha" type="range" onchange="ps().setEdgeSmoothing(this.value);"><br><br>
Initial separation<br><input step="0.005" max="0.05" min="0.0" value="0.015" name="separationFactor" type="range"  onchange="setSeparationFactor(this.value);"><br><br>
Repellence<br><input step="0.05" max="1.0" min="0.0" value="0.25" name="repelencePenalty" type="range" onchange="ps().setRepellence(this.value);"><br><br>

<input type="button" value="Bundle!"  id="bundle" onclick="iteration(10);"  style="font-weight:bold;">
<input type="button" value="+1 step" id="iteration" onclick="iteration(1);">
<input type="button" value="Reset" id="reset" onclick="reset();">
<br>
<br>


<br>
<br>
<font size=3 color="white">Finally, adjust rendering</font></big><br><br>	

<input value="1" name="invertColors" type="checkbox" onchange="setInvertColors(this.checked);" >Invert colours<br><br>
<input value="2" name="useStrokeWeight" type="checkbox"  onchange="setUseWeight(this.checked);"  checked="checked">Weight edges<br><br>
Edge alpha<br><input step="0.005" max="0.25" min="0.005" value="0.011764706" name="edgeAlpha" type="range"   onmouseup="setEdgeAlpha(this.value);" ><br><br>


<input type="button" value="Save"  id="btn-save" onclick="ps().saveImage();">
<input type="button" value="Save Hi-Res"   id="btn-savehr" onclick="ps().saveImageHR();">



<!--
<br>
<br>




<br>
<br>
<br>
<br>
<br>	
<input type="text" value="my text" id="inputtext"><br>	
-->		
	</div>	
		
		
		
		
		
		
			<div id="divjs" style="margin-left: 250px;">
				<canvas id="threeDHEBjs" data-processing-sources="threeDHEB_js.pde" 
						width="800" height="800">
					<p>Your browser does not support the canvas tag.</p>
					<!-- Note: you can put any alternative content here. -->
				</canvas>
				<noscript>
					<p>JavaScript is required to view the contents of this page.</p>
				</noscript>
	    	</div>
	    	
	    	<div id="divdescr" style="margin-left: 250px;">
				<h1>3DHEB - 3D Histogram-based Edge Bundling</h1>
				
    		<p id="description">
    		<big>by <b><a href="mailto:daniel.c.moura@gmail.com">Daniel C. Moura</a></b>.</big> 
    		Built with <a href="http://processing.org" title="Processing">Processing</a>
			and <a href="http://processingjs.org" title="Processing.js">Processing.js</a>
    		<br>
    		<br>
    		<br>
    		Simplified version of the 3DHEB bundling algorithm described <a href="http://arxiv.org/abs/1504.02687">here</a>.</br>
    		If you use this software or images generated by this software, please give me credit by citing the following work:
<pre>
@ARTICLE{moura2015_3dheb,
   author = {{Moura}, Daniel C.},
    title = "{{3D} Density Histograms for Criteria-driven Edge Bundling}",
  journal = {ArXiv e-prints},
   eprint = {1504.02687},
     year = 2015,
    month = apr
}
 </pre>   		
 
    		<br>    		
    		</p>

			<big>
			Also, check out this video created with 3DHEB: <a href="javascript:window.open('http://vimeo.com/danielcmoura/3dheb');">vimeo.com/danielcmoura/3dheb</a>!
			</big>
			<!-- <iframe src="https://player.vimeo.com/video/124638700" width="800" height="415" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> <p><a href="https://vimeo.com/124638700">Origins and destinations of Porto&rsquo;s bus passengers based on Wi-Fi</a> from <a href="https://vimeo.com/danielcmoura">Daniel Moura</a> on <a href="https://vimeo.com">Vimeo</a>.</p> -->
	    	</div>
			
			

			
		</div>
		
		<div id="tst" class="modal"><!-- Place at bottom of page --></div>
	</body>
</html>
